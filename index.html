<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student-University Matching</title>
  <!-- <script src="https://unpkg.com/javascript-lp-solver/prod/solver.js"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script> -->
  <script src="libs/solver.js"></script>
  <script src="libs/papaparse.min.js"></script>
  <script src="libs/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Student-University Matching</h1>
  <p class="info-text">Upload university and student CSV files to run the matching algorithm.</p>
  <div>
    <label>Universities agreement CSV: <input type="file" id="universitiesFile" accept=".csv,.xlsx,.xls"></label>
    <label>Student applicants CSV: <input type="file" id="applicantsFile" accept=".csv,.xlsx,.xls"></label>
  </div>
  
  <div id="prefWeightsContainer" style="display: none; margin-top: 15px;">
    <h2>Preference Weights</h2>
    <p class="info-text">Lower numbers are preferred. Set a custom weight per choice (1 to 6) to encourage or discourage certain choices.</p>
    <div class="weights-grid">
      <label>Choice 1: <input type="number" id="weight_1" min="0" step="1" value="1"></label>
      <label>Choice 2: <input type="number" id="weight_2" min="0" step="1" value="2"></label>
      <label>Choice 3: <input type="number" id="weight_3" min="0" step="1" value="3"></label>
      <label>Choice 4: <input type="number" id="weight_4" min="0" step="1" value="4"></label>
      <label>Choice 5: <input type="number" id="weight_5" min="0" step="1" value="5"></label>
      <label>Choice 6: <input type="number" id="weight_6" min="0" step="1" value="6"></label>
    </div>
    <div style="margin-top: 8px;">
      <button id="resetWeightsBtn" class="export-csv-btn" type="button">Reset weights</button>
    </div>
    <div class="info-text" style="margin-top:10px;">
      <strong>How weights affect matching:</strong>
      <ul style="margin:6px 0 0 18px;">
        <li>Raising a specific choiceâ€™s weight discourages that choice; lowering it makes it more acceptable.</li>
      </ul>
    </div>
  </div>
  
  <div id="manualAssignment" style="display: none;">
    <h2>Manual Assignment</h2>
    <div class="manual-controls">
      <div class="search-container">
        <input type="text" id="studentSearch" placeholder="Search for student...">
        <div id="studentResults" class="search-results"></div>
      </div>
      <div class="assignment-container" style="display: none;">
        <h3>Assign <span id="selectedStudentName"></span></h3>
        <div id="preferenceOptions"></div>
  <button id="addAssignmentBtn">Add Assignment</button>
  <button id="forbidAssignmentBtn" title="Disallow this student-university pair">Forbid</button>
        <button id="cancelAssignmentBtn">Cancel</button>
      </div>
    </div>
    <div id="forbiddenAssignmentsList" style="margin-top:16px;">
      <h3>Forbidden Assignments</h3>
      <table id="forbiddenAssignmentsTable">
        <thead>
          <tr>
            <th>Student</th>
            <th>Forbidden University</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div id="manualAssignmentsList">
      <h3>Manual Assignments</h3>
      <table id="manualAssignmentsTable">
        <thead>
          <tr>
            <th>Student</th>
            <th>Assigned University</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  
  <div id="results"></div>
  <script src="script.js"></script>
</body>
</html>